- for recording mode, on the main thread it should enable a rest endpoint for syncing mode, in which it provides an endpoint to fetch all metadata from a particular show's sqlite database together with the min and max id at the time, and another api endpoint to fetch database records with ranges. Recording mode should reject database flagged with is_recipient = true.
- add another command line option for syncing mode, in which it creates a new database per show with is_recipient = true or opens a separate sqlite database. If database already exists, check if database is recipient mode metadata matches from api endpoint including metadata session id, and get the last synced database id from metadata instead of max(id) because I might trim the data which makes max(id) less reliable.
- for syncing, it will keep on pulling data until it reaches the max id from the recording mode at the time of starting sync. It should pull data in chunks, and after each chunk it should update the last synced id in metadata table. after finish syncing, the program should exit.
- rationale for syncing mode: currently I have stable internet on remote recording server, but it doesn't have a stable connection for postgresql, so I need to record locally and sync asynchronously.
- future plan, don't implement now: for recording mode, delete records older than a week except the last one defined by natural boundary to prevent unbound database growth on remote server where space is limited.